# OPROプロンプトテンプレート

このテンプレートは、OPRO（Optimization by PROmpting）手法でプロンプトを最適化するためのフォーマットです。

---

## 基本OPROテンプレート

```markdown
あなたはプロンプト最適化の専門家です。以下のプロンプトを改善してください。

【現在のプロンプト】
{existing_prompt}

【品質基準】
{quality_standards}

【改善方向】
1. 明確性: 曖昧な表現を具体化
2. 完全性: 欠けている要素を追加
3. 構造性: 段階的な指示に再構築
4. 例示性: 良い例/悪い例を追加
5. 実行可能性: アクション指向の表現に

【制約】
- 元のプロンプトの意図を保持
- 長さは元の1.5倍以内
- 技術的正確性を維持

【出力形式】
最適化されたプロンプトをマークダウン形式で出力してください。
```

---

## 反復1用テンプレート（初期改善）

```markdown
あなたはプロンプト最適化の専門家です。

【タスク】
以下のプロンプトを大幅に改善してください。これは最初の反復なので、構造全体を見直し、基礎的な品質を向上させることに集中してください。

【現在のプロンプト（バージョン1）】
{initial_prompt}

【現在のスコア】
- 明確性: {clarity_score}/10
- 完全性: {completeness_score}/10
- 構造性: {structure_score}/10
- 例示性: {examples_score}/10
- 実行可能性: {actionability_score}/10
**合計**: {total_score}/50

【品質基準（参照: lecture-quality-standards）】
{quality_standards}

【反復1の改善戦略】
1. **全体構造の改善**（構造性を優先）
   - セクション分けを明確化
   - 論理的な流れを作る
   - 段階的な指示に再構築

2. **基礎的な明確化**（明確性を優先）
   - 曖昧な表現を具体化
   - 専門用語を定義
   - 判断基準を明示

3. **必須要素の追加**（完全性を優先）
   - 入力・出力形式を指定
   - 品質基準を明記
   - 制約条件を追加

【改善目標】
- 総合スコア: 35/50以上
- すべての軸で5/10以上

【制約】
- プロンプトの本質的な目的を変えない
- 長さは現在の1.5倍以内（{current_length}文字 → {max_length}文字）
- 既存の良い部分は保持

【出力】
改善されたプロンプトをマークダウン形式で出力してください。
```

---

## 反復2用テンプレート（標的改善）

```markdown
あなたはプロンプト最適化の専門家です。

【タスク】
以下のプロンプトを、低スコアの軸を集中的に改善してください。

【現在のプロンプト（バージョン2）】
{current_prompt}

【現在のスコア】
- 明確性: {clarity_score}/10
- 完全性: {completeness_score}/10
- 構造性: {structure_score}/10
- 例示性: {examples_score}/10
- 実行可能性: {actionability_score}/10
**合計**: {total_score}/50

【前回からの改善】
反復1の改善:
- 構造性: {old_structure_score} → {clarity_score} (+{improvement}点)
- 明確性: {old_clarity_score} → {clarity_score} (+{improvement}点)
- 完全性: {old_completeness_score} → {completeness_score} (+{improvement}点)

【品質基準】
{quality_standards}

【反復2の改善戦略】
1. **低スコア軸の集中改善**
   現在のスコア分析:
   - {lowest_axis_1}: {score}/10 ← 最優先
   - {lowest_axis_2}: {score}/10 ← 次優先

2. **標的改善アプローチ**
   {lowest_axis_1}の改善:
   - [具体的な改善策1]
   - [具体的な改善策2]

   {lowest_axis_2}の改善:
   - [具体的な改善策1]
   - [具体的な改善策2]

3. **既存の良い点の保持**
   - {highest_axis}: {score}/10 ← これは維持

【改善目標】
- 総合スコア: 42/50以上
- 最低スコア軸を8/10以上に

【制約】
- プロンプトの本質的な目的を維持
- 長さは現在の1.2倍以内（{current_length}文字 → {max_length}文字）
- 前回の良い改善点は必ず保持

【出力】
改善されたプロンプトと、以下の情報を出力してください：
1. 改善されたプロンプト（マークダウン形式）
2. 主な改善点（箇条書き）
3. 期待されるスコア向上
```

---

## 反復3用テンプレート（最終調整）

```markdown
あなたはプロンプト最適化の専門家です。

【タスク】
以下のプロンプトを最終調整し、完成度を高めてください。大きな変更ではなく、微調整とポリッシングに集中してください。

【現在のプロンプト（バージョン3）】
{current_prompt}

【現在のスコア】
- 明確性: {clarity_score}/10
- 完全性: {completeness_score}/10
- 構造性: {structure_score}/10
- 例示性: {examples_score}/10
- 実行可能性: {actionability_score}/10
**合計**: {total_score}/50

【改善履歴】
反復1: {v1_score}/50
反復2: {v2_score}/50 (+{improvement}点)
反復3: {v3_score}/50 (+{improvement}点)

【品質基準】
{quality_standards}

【反復3の改善戦略】
1. **微調整とポリッシング**
   - 用語の統一
   - 文章の洗練
   - フォーマットの一貫性

2. **残存する小さな問題の解決**
   各軸の現状:
   - {axis_1}: {score}/10 → {target}/10を目指す
   - {axis_2}: {score}/10 → {target}/10を目指す

3. **全体の完成度向上**
   - チェックリストで最終確認
   - 例の質を向上
   - 視覚的な読みやすさ

【改善目標】
- 総合スコア: 45/50以上（90%）
- すべての軸で8/10以上

【制約】
- 大きな構造変更は避ける
- 長さは現在の1.1倍以内（{current_length}文字 → {max_length}文字）
- 過去2回の改善点をすべて保持

【出力】
以下を出力してください：
1. 最終調整されたプロンプト（マークダウン形式）
2. 反復1からの主な改善点のサマリー
3. 最終品質評価
```

---

## 特殊用途テンプレート

### A/Bテスト型OPRO

```markdown
あなたはプロンプト最適化の専門家です。

【タスク】
以下のプロンプトを2つの異なるアプローチで改善してください。

【現在のプロンプト】
{existing_prompt}

【品質基準】
{quality_standards}

【アプローチA: 明確性と構造性を最大化】
- 明確性: 10/10を目指す
- 構造性: 10/10を目指す
- トレードオフ: 長さが増える可能性

【アプローチB: 例示性と実行可能性を最大化】
- 例示性: 10/10を目指す
- 実行可能性: 10/10を目指す
- トレードオフ: 詳細すぎる可能性

【出力】
## バージョンA（明確性・構造性重視）
[改善されたプロンプト]

**期待スコア**:
- 明確性: X/10
- 構造性: X/10
- 総合: X/50

## バージョンB（例示性・実行可能性重視）
[改善されたプロンプト]

**期待スコア**:
- 例示性: X/10
- 実行可能性: X/10
- 総合: X/50

## 推奨
[どちらのアプローチが優れているか、理由と共に]
```

### 段階的OPRO

```markdown
あなたはプロンプト最適化の専門家です。

【タスク】
以下のプロンプトを3段階で改善してください。

【現在のプロンプト】
{existing_prompt}

【品質基準】
{quality_standards}

【段階1: 骨格の最適化（構造性のみ）】
目標:
- セクション分けを明確化
- 論理的な流れを作る
- 段階的な指示に再構築

制約:
- 内容の追加は最小限
- 構造の改善に集中

【段階2: 内容の充実（完全性・例示性）】
目標:
- 欠けている要素を追加
- 例を豊富に（良い例・悪い例）
- 詳細を充実

制約:
- 段階1の構造を維持
- 内容の追加に集中

【段階3: 洗練（明確性・実行可能性）】
目標:
- 曖昧な表現を具体化
- 実行可能な指示に変換
- 用語の統一

制約:
- 段階1-2の成果を維持
- 微調整に集中

【出力】
各段階の改善結果を順次出力してください。
```

---

## OPROプロンプトの品質チェックリスト

OPROプロンプト自体が以下を満たしているか確認：

```yaml
opro_prompt_quality:
  clarity:
    - [ ] 改善方向が具体的
    - [ ] 品質基準が明確
    - [ ] 制約が明示的

  guidance:
    - [ ] 改善戦略が詳細
    - [ ] 期待される成果物が明確
    - [ ] 例や参考情報が豊富

  constraints:
    - [ ] 保持すべき点が明確
    - [ ] 変更してはいけない点が明確
    - [ ] 長さ制限が適切

  effectiveness:
    - [ ] 反復ごとに戦略が変わる
    - [ ] スコアフィードバックを活用
    - [ ] 過去の改善を考慮
```

---

## トラブルシューティング用テンプレート

### スコアが停滞した場合

```markdown
あなたはプロンプト最適化の専門家です。

【状況】
過去2回の反復でスコアが改善していません。

【現在のプロンプト（バージョン{version}）】
{current_prompt}

【スコア履歴】
- 反復{n-2}: {score}/50
- 反復{n-1}: {score}/50（改善なし）
- 現在: {score}/50（改善なし）

【品質基準】
{quality_standards}

【診断】
なぜスコアが改善しないのか、以下の観点で分析してください：
1. 改善の方向性が間違っている？
2. 品質基準の理解が不足？
3. ローカル最適解に陥っている？
4. プロンプトが複雑すぎる？

【新しいアプローチ】
過去2回と異なる、全く新しいアプローチで改善を試みてください：
- 過去の改善を一旦リセット
- 元のプロンプトから再出発
- 異なる軸を優先
- 異なる構造を試す

【出力】
1. スコア停滞の原因分析
2. 新しいアプローチの説明
3. 改善されたプロンプト
```

---

## 実践例

### 例1: 講義資料生成プロンプトの最適化

**初期プロンプト（スコア25/50）**:
```markdown
講義資料を作成してください。
```

**OPRO反復1適用**:
```markdown
あなたはプロンプト最適化の専門家です。以下のプロンプトを改善してください。

【現在のプロンプト】
講義資料を作成してください。

【品質基準】
lecture-quality-standardsに準拠
- 構造化された章立て
- 具体例が豊富
- 段階的な説明

【改善方向】
1. 明確性: 何をどのように作成するか具体化
2. 完全性: 必須セクション、フォーマットを指定
3. 構造性: ステップバイステップの指示に
4. 例示性: 良い例・悪い例を示す
5. 実行可能性: チェックリストを追加

【出力形式】
最適化されたプロンプトをマークダウン形式で出力してください。
```

**改善結果（スコア38/50）**:
```markdown
あなたはVibeCoder育成プログラムの講義資料作成の専門家です。

【タスク】
以下の構造に従って、Markdown形式の講義資料を生成してください。

【必須セクション】
1. タイトルとメタ情報
2. 学習目標（🎯）
3. 前提知識（📌）
4. 本文（💡）
5. まとめ（🚀）

【品質基準】
- 各セクションに1つ以上の具体例
- 2つ以上のMermaid図
- 1つ以上の比較表

【チェックリスト】
- [ ] すべてのセクションが存在
- [ ] 学習目標が3つ以上
- [ ] 具体例が豊富
```

### 例2: 反復2での標的改善

**現在のスコア分析**:
- 明確性: 8/10 ← 良好
- 完全性: 7/10 ← 改善余地
- 構造性: 8/10 ← 良好
- 例示性: 5/10 ← 要改善
- 実行可能性: 7/10 ← 改善余地

**OPRO反復2（例示性と実行可能性に集中）**:

改善後（スコア44/50）:
- 例示性: 5 → 9（+4点）
- 実行可能性: 7 → 9（+2点）

---

**戻る**: [SKILL.md](../SKILL.md)
