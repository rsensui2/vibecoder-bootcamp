# 批評テンプレート（Self-Refine用）

このテンプレートは、Self-Refine手法でプロンプトを自己批評するためのフォーマットです。

---

## 基本批評テンプレート

```markdown
あなたはプロンプト品質の批評家です。以下のプロンプトを厳しく評価してください。

【評価対象プロンプト】
{prompt_to_critique}

【品質基準】
{quality_standards}

【批評観点】
以下の5つの軸で問題点を指摘してください：

1. **明確性**: 曖昧な表現、誤解を招く表現
2. **完全性**: 欠けている要素、考慮漏れ
3. **構造性**: 分かりにくい構造、論理の飛躍
4. **例示性**: 不足している例、不適切な例
5. **実行可能性**: 実行困難な指示、抽象的すぎる表現

【出力形式】
## 問題点（各軸ごと）

### 明確性（現在スコア: X/10）
- [問題点1]: 具体的な箇所と改善案
- [問題点2]: 具体的な箇所と改善案

### 完全性（現在スコア: X/10）
- [問題点1]: 具体的な箇所と改善案
- [問題点2]: 具体的な箇所と改善案

### 構造性（現在スコア: X/10）
- [問題点1]: 具体的な箇所と改善案

### 例示性（現在スコア: X/10）
- [問題点1]: 具体的な箇所と改善案

### 実行可能性（現在スコア: X/10）
- [問題点1]: 具体的な箇所と改善案

## 改善優先度
1. [最優先の改善点]（期待効果: +X点）
2. [次に重要な改善点]（期待効果: +X点）
3. [その次の改善点]（期待効果: +X点）

## 改善案
- [具体的な改善案1]
- [具体的な改善案2]
- [具体的な改善案3]
```

---

## 高度な批評テンプレート（反復用）

```markdown
あなたはプロンプト品質の批評家です。以下のプロンプトを、過去の改善履歴を踏まえて評価してください。

【評価対象プロンプト（バージョン {version}）】
{current_prompt}

【現在のスコア】
- 明確性: {clarity_score}/10
- 完全性: {completeness_score}/10
- 構造性: {structure_score}/10
- 例示性: {examples_score}/10
- 実行可能性: {actionability_score}/10
**合計**: {total_score}/50

【過去の改善履歴】
{improvement_history}

【品質基準】
{quality_standards}

【批評観点】
以下の観点で、**まだ改善の余地がある点**を指摘してください：

1. **残存する曖昧性**: 過去の改善でも解消されていない曖昧な表現
2. **新たな問題**: 改善によって生じた新しい問題（冗長性、複雑性など）
3. **一貫性の欠如**: 用語、スタイル、フォーマットの不統一
4. **バランスの問題**: 過剰な部分と不足している部分
5. **実用性の問題**: 実際に使いにくい、理解しにくい部分

【出力形式】
## 残存する問題点

### 重大な問題（スコアへの影響: 大）
- [問題1]: なぜ問題か、どう改善するか、期待効果
- [問題2]: なぜ問題か、どう改善するか、期待効果

### 軽微な問題（スコアへの影響: 小）
- [問題1]: なぜ問題か、どう改善するか、期待効果
- [問題2]: なぜ問題か、どう改善するか、期待効果

## 改善による副作用
- [改善によって生じた新たな問題]

## 次回の改善方針
1. [最優先の改善点]（期待スコア向上: +X点）
2. [次に重要な改善点]（期待スコア向上: +X点）
3. [その次の改善点]（期待スコア向上: +X点）
```

---

## 批評の観点別テンプレート

### 観点1: 明確性の批評

```markdown
## 明確性の批評（現在スコア: X/10）

### 曖昧な表現
| 箇所 | 曖昧な表現 | なぜ曖昧か | 改善案 |
|------|-----------|-----------|--------|
| セクション1 | "適切に処理" | 何が適切か不明 | "以下の3ステップで処理" |
| セクション3 | "良い品質" | 品質の基準不明 | "スコア45/50以上" |

### 未定義の用語
- [用語1]: 初出時に定義すべき
- [用語2]: 専門用語の説明が必要

### 誤解を招く表現
- [箇所]: 複数の解釈が可能、意図を明確化すべき

### 改善優先度
1. [最も曖昧な表現]（影響度: 高）
2. [次に曖昧な表現]（影響度: 中）
```

### 観点2: 完全性の批評

```markdown
## 完全性の批評（現在スコア: X/10）

### 欠けている要素
- [ ] 入力形式の指定
- [ ] 出力形式の指定
- [ ] エラー処理の指示
- [ ] 品質基準の定義
- [ ] 例外ケースの考慮

### 不十分な詳細
| 要素 | 現状 | 必要な追加情報 |
|------|------|---------------|
| セクション1 | 概要のみ | 具体的なステップ |
| セクション2 | 例が1つ | 3つ以上必要 |

### 考慮漏れ
- [シナリオ1]: このケースが考慮されていない
- [シナリオ2]: この例外が考慮されていない

### 改善優先度
1. [最も重要な欠落要素]（影響度: 高）
2. [次に重要な欠落要素]（影響度: 中）
```

### 観点3: 構造性の批評

```markdown
## 構造性の批評（現在スコア: X/10）

### 論理の飛躍
- [箇所1]: ステップAからステップCへ、ステップBが欠落
- [箇所2]: 前提条件なしに結論

### セクション間の繋がり
- [問題1]: セクション2と3の繋がりが不明瞭
- [問題2]: セクション4が唐突に開始

### 階層構造の問題
- [問題1]: 見出しレベルが不適切（h2とh3が混在）
- [問題2]: 箇条書きの階層が深すぎる（4階層）

### 読みやすさの問題
- [問題1]: 長すぎる段落（300文字）
- [問題2]: 視覚的な区切りが不足

### 改善優先度
1. [最も重大な構造問題]（影響度: 高）
2. [次に重大な構造問題]（影響度: 中）
```

### 観点4: 例示性の批評

```markdown
## 例示性の批評（現在スコア: X/10）

### 例の不足
| セクション | 現在の例数 | 必要な例数 | 不足 |
|-----------|-----------|-----------|------|
| セクション1 | 1 | 3 | 2 |
| セクション2 | 0 | 2 | 2 |

### 例の質
- [例1]: 抽象的すぎる、具体的なコードや数値が必要
- [例2]: 実行不可能、動作するコードに修正すべき
- [例3]: 古い情報、最新のベストプラクティスに更新

### 悪い例の不足
- 良い例のみで、悪い例がない
- なぜダメなのか説明がない

### 例のバランス
- [ ] 良い例: 3つ以上
- [ ] 悪い例: 2つ以上
- [ ] 実践例: 1つ以上（コード付き）
- [ ] 多様性: 異なるシナリオ

### 改善優先度
1. [最も重要な例の追加]（影響度: 高）
2. [次に重要な例の追加]（影響度: 中）
```

### 観点5: 実行可能性の批評

```markdown
## 実行可能性の批評（現在スコア: X/10）

### 抽象的な指示
| 箇所 | 抽象的な指示 | なぜ実行困難か | 改善案 |
|------|-------------|---------------|--------|
| ステップ1 | "分析してください" | 何をどう分析するか不明 | "以下の3項目を分析" |
| ステップ2 | "品質を確認" | 確認基準が不明 | "チェックリストで確認" |

### 成果物の不明確さ
- [タスク1]: 何を作成すべきか不明
- [タスク2]: 完了の定義が不明

### 判断基準の不足
- [箇所1]: 良し悪しの判断基準がない
- [箇所2]: 成功の定義がない

### ツール・手法の不明確さ
- [タスク1]: どのツールを使うべきか不明
- [タスク2]: どの手法を適用すべきか不明

### 改善優先度
1. [最も実行困難な指示]（影響度: 高）
2. [次に実行困難な指示]（影響度: 中）
```

---

## 批評の具体例

### 例1: 明確性の批評

**対象箇所**:
```markdown
コードを適切にレビューしてください。
```

**批評**:
```markdown
### 明確性の問題

**問題点**: "適切に"が曖昧

**なぜ問題か**:
- 何が「適切」なのか基準不明
- レビュー観点が不明
- 期待される出力が不明

**改善案**:
```markdown
以下の3つの観点でコードをレビューしてください：
1. セキュリティ: XSS、SQLインジェクション
2. パフォーマンス: O(n²)以上のアルゴリズム
3. 可読性: 変数名の明確さ、コメント比率20%以上
```

**期待効果**: 明確性が+3点向上
```

### 例2: 完全性の批評

**対象箇所**:
```markdown
## 講義資料生成

タイトル、内容、まとめを含めてください。
```

**批評**:
```markdown
### 完全性の問題

**欠けている要素**:
- [ ] メタ情報（日付、所要時間）
- [ ] 学習目標
- [ ] 前提知識
- [ ] 具体例の要件
- [ ] 図表の要件
- [ ] 品質基準

**不十分な詳細**:
- "内容"が曖昧（何セクション？）
- "まとめ"の構成不明

**改善案**:
各セクションに以下を追加：
1. メタ情報: 講義番号、日付、所要時間
2. 学習目標: 3-5個、「〜できる」形式
3. 前提知識: 必須と推奨を分ける
4. 本文: 3セクション以上、各セクションに例1つ
5. まとめ: 重要ポイント3つ、次のステップ

**期待効果**: 完全性が+4点向上
```

### 例3: 例示性の批評

**対象箇所**:
```markdown
良いコミットメッセージを書いてください。
```

**批評**:
```markdown
### 例示性の問題

**現状**: 例が全くない

**必要な例**:
- ✅ 良い例: 3つ（機能追加、バグ修正、リファクタリング）
- ❌ 悪い例: 2つ（不明瞭、詳細すぎ）
- 💡 実践例: 1つ（実際のgitコマンド付き）

**改善案**:
```markdown
### ✅ 良い例1: 機能追加
\`\`\`
feat: Google OAuth認証を追加

- Clerk SDKを統合
- ログインボタンを配置
\`\`\`
**なぜ良い**: プレフィックス明確、概要簡潔

### ❌ 悪い例1: 不明瞭
\`\`\`
update
\`\`\`
**なぜダメ**: 何を更新したか不明
```

**期待効果**: 例示性が+5点向上
```

---

## 批評品質のチェックリスト

良い批評には以下が含まれます：

```yaml
quality_critique_checklist:
  specificity:
    - [ ] 具体的な箇所を引用している
    - [ ] 問題の理由を説明している
    - [ ] 改善案が具体的

  actionability:
    - [ ] すぐに実行可能な改善案
    - [ ] 期待される効果を明示
    - [ ] 優先順位が明確

  balance:
    - [ ] すべての軸を評価
    - [ ] 重大な問題と軽微な問題を区別
    - [ ] 過去の改善を考慮

  constructiveness:
    - [ ] 批判だけでなく、建設的な提案
    - [ ] 良い点も認識
    - [ ] 実現可能な改善
```

---

## 悪い批評の例（避けるべき）

### ❌ 悪い批評例1: 抽象的

```markdown
## 問題点
- 明確性が低い
- 例が不足
- 構造が悪い
```

**何が問題か**: 具体性がない、改善案がない、実行不可能

### ❌ 悪い批評例2: 非建設的

```markdown
## 問題点
- このプロンプトは全く使えない
- 一から書き直すべき
- センスがない
```

**何が問題か**: 感情的、建設的でない、改善の方向性がない

### ❌ 悪い批評例3: 過剰

```markdown
## 問題点
- 1文目の助詞が不自然
- 2文目の句読点の位置
- 3文目の漢字が難しすぎる
（50個の細かい指摘が続く...）
```

**何が問題か**: 重箱の隅、優先順位がない、本質的でない

---

## ✅ 良い批評の例

```markdown
## 残存する問題点

### 重大な問題（スコアへの影響: 大）

#### 問題1: 例の不足（例示性: 現在5/10）
**箇所**: セクション3「コードレビュー」
**問題**: 良い例が1つのみ（基準では3つ必要）
**なぜ問題か**: 読者が具体的なイメージを持てない
**改善案**:
- セキュリティレビューの例を追加
- パフォーマンスレビューの例を追加
- 可読性レビューの例を追加
**期待効果**: 例示性が+3点向上

#### 問題2: 成果物の不明確さ（実行可能性: 現在7/10）
**箇所**: ステップ4「検証」
**問題**: 何をどう検証するか不明
**なぜ問題か**: 実行者が判断に迷う
**改善案**:
チェックリスト形式に変更：
- [ ] すべてのテストが合格
- [ ] TypeScriptエラーなし
- [ ] ESLint警告なし
**期待効果**: 実行可能性が+2点向上

### 軽微な問題（スコアへの影響: 小）

#### 問題1: 用語の不統一（明確性: 現在9/10）
**箇所**: セクション2とセクション5
**問題**: 「ユーザー」と「利用者」が混在
**改善案**: 「ユーザー」に統一
**期待効果**: 明確性が+0.5点向上

## 改善優先度
1. 例の追加（期待: +3点）← 最優先
2. 検証チェックリストの追加（期待: +2点）
3. 用語の統一（期待: +0.5点）

## 次回の改善方針
例示性と実行可能性に集中し、スコア45/50以上を目指す。
```

---

**戻る**: [SKILL.md](../SKILL.md)
