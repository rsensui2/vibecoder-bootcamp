# 第三回 VibeCoder育成プログラム トークスクリプト

**2025年9月版**

---

## 📋 全体構成（約3時間）

| セッション | 時間 | 内容 |
|---------|------|------|
| Session 1 | 90分 | DB基礎とSupabase実装 |
| 休憩 | 10分 | |
| Session 2 | 75分 | 認証基礎とClerk実装 |
| 休憩 | 5分 | |
| Session 3 | 30分 | 実装ロードマップと宿題 |

---

# Session 1: DB基礎とSupabase実装（90分）

## オープニング（5分）

### 導入トーク

「みなさん、こんにちは！第三回へようこそ！

前回、フロントエンドの実装を完了して、美しいUIができましたね。
でも今、そのアプリは『ハリボテ』の状態です。
見た目は綺麗だけど、データを保存できない。
ページをリロードしたら全部消えてしまう。

**今日はそこに『魂』を吹き込みます。**
つまり、**データベース**と**認証**の実装です。

この2つを実装すると...
- ユーザーがログインできる
- 投稿が保存される
- 他の人のデータは触れない
- リロードしてもデータが残る

本物のWebアプリケーションが完成します！」

---

## 第1部：なぜデータベースが必要なのか？（15分）

### トーク1：身近な例から始める

「まず質問です。
Instagramを使ったことある人、手を挙げてください。

（挙手を確認）

Instagramって、写真を投稿しますよね。
その写真、どこに保存されてると思いますか？

そうです、**データベース**です。

でも、最初は『スプレッドシートでいいんじゃない？』って思いませんか？

実際、私たちが日常で使ってるスプレッドシートも、
データを整理して保存する点では似ています。

じゃあ、なぜわざわざデータベースを使うのか。
**その違いを体感してもらいます。**」

---

### 実演：スプレッドシートでSNSを作る

「画面を共有しますね。
（Google スプレッドシートを開く）

今から、このスプレッドシートで簡単なSNSを作ってみます。

**シート1：users（ユーザー情報）**

| user_id | email | username | created_at |
|---------|-------|----------|------------|
| 1 | yamada@example.com | yamada_taro | 2025-01-01 |
| 2 | tanaka@example.com | tanaka_hanako | 2025-01-02 |

こんな感じで、ユーザー情報を管理できますね。

**シート2：posts（投稿）**

| post_id | user_id | content | created_at |
|---------|---------|---------|------------|
| 1 | 1 | おはようございます！ | 2025-01-10 |
| 2 | 2 | カフェなう☕️ | 2025-01-10 |

投稿も管理できます。

ここで重要なのが『user_id』です。
postsの user_id = 1 は、usersの user_id = 1 と繋がっています。

これを**リレーション（関連）**と言います。

VLOOKUPを使えば...

（実演：投稿者名を自動表示）

ほら、投稿者の名前が自動で表示されました。

**これがデータベースの基本概念です！**」

---

### トーク2：スプレッドシートの限界

「でも、これには**大きな問題**があります。

想像してください。
このSNSが成長して...

- ユーザー数：100万人
- 投稿数：1億件
- 同時アクセス：1000人

こうなったとき、何が起こるか。

（画面を見せながら）

1. **ファイルが重すぎて開けない**
   - 開くのに5分、10分...
   - 最悪、クラッシュします

2. **同時編集で壊れる**
   - AさんとBさんが同じ行を編集
   - データが消える、壊れる

3. **セキュリティがゼロ**
   - 全員が全データを見られる
   - パスワードも丸見え

4. **検索が遅すぎる**
   - VLOOKUPが1つ実行されるのに数秒
   - ユーザーは待てません

これが、スプレッドシートの限界です。

だから、プロダクションレベルのアプリには
**データベースが必要なんです。**」

---

## 第2部：データベース基礎（20分）

### トーク3：用語の理解

「では、データベースの基本用語を覚えましょう。
でも安心してください。
**スプレッドシートと対応させて**理解すれば簡単です。

（スライドを表示）

| データベース用語 | スプレッドシート |
|--------------|--------------|
| データベース | ファイル全体（.xlsx） |
| テーブル | シート |
| レコード（行） | 行 |
| カラム（列） | 列 |
| 主キー | ID列（重複しない） |
| 外部キー | 他シート参照 |

ほら、既に知ってる概念ばかりでしょ？

データベースは、スプレッドシートの
**超強化版**だと思ってください。」

---

### ハンズオン指示

「じゃあ、実際に手を動かしましょう！

みなさん、Google スプレッドシートを開いてください。

**これから一緒に作るもの：**
SNSアプリのデータベース設計

**作成するシート：**
1. users（ユーザー情報）
2. posts（投稿）
3. likes（いいね）
4. follows（フォロー関係）

（画面を見せながら、一緒に入力していく）

まず、usersシートから...

（10分程度、受講者と一緒に入力）

どうですか？
これで、データの構造が視覚的に理解できましたね。

でも、これをコードで表現するのが**SQL**です。」

---

### トーク4：SQLとは何か

「SQL（エスキューエル）って聞いたことありますか？

**SQL = Structured Query Language**
構造化問い合わせ言語

難しそうに聞こえますが、実は**英語に近い**文法です。

例えば...

（スライドを表示）

```sql
SELECT * FROM users WHERE name = '山田'
```

これ、日本語に訳すと：
『usersから、名前が山田のデータを全部選んで』

ほぼ英語ですよね？

でも、**朗報です！**

Vibe Coderのみなさんは、
**SQLを覚える必要はありません。**

なぜなら...
**AIに書かせるから！**」

---

### トーク5：AIにSQLを生成させる

「実演します。Cursorを開きますね。

（Cursorを起動）

私が今からAIに指示を出します。
見ててください。

『山田太郎さんの全投稿を新しい順に取得するSQLを書いて』

（AIが生成するのを待つ）

ほら、数秒で完璧なSQLが生成されました！

```sql
SELECT p.*, u.name
FROM posts p
JOIN users u ON p.user_id = u.id
WHERE u.name = '山田太郎'
ORDER BY p.created_at DESC;
```

私がこれを書けるようになるには、
従来なら**1ヶ月**かかりました。

でも今は、**日本語で伝えるだけ。**

これがAI時代の開発スタイルです！」

---

## 第3部：Supabaseで実装（40分）

### トーク6：なぜSupabaseか

「さて、実際にデータベースを構築します。

使うのは**Supabase（スパベース）**。

なぜSupabaseか？

（スライドを表示）

**理由1：無料で始められる**
- 500MBまで無料
- 個人開発なら十分

**理由2：管理画面が使いやすい**
- スプレッドシートみたいに見られる
- データの追加・編集が簡単

**理由3：認証機能が組み込み済み**
- 今日後半で使います

**理由4：リアルタイム機能**
- チャットアプリとかも作れる

他にも選択肢はあります。
Firebase、PlanetScale...

でも、初心者には**Supabaseが最適**です。」

---

### 実演：Supabaseプロジェクト作成

「じゃあ、みなさんも一緒に作りましょう！

**ステップ1：アカウント作成**

1. https://supabase.com を開いてください
2. 『Start your project』をクリック
3. GitHubでサインイン

（受講者が操作するのを待つ）

できましたか？

**ステップ2：プロジェクト作成**

1. 『New Project』をクリック
2. プロジェクト名を入力
   - 例：`vibe-coder-sns`
3. データベースパスワードを設定
   - **これは絶対に忘れないように！**
   - メモ帳にコピーしておいてください
4. リージョンを選択
   - 『Tokyo』を選んでください
   - 日本に近いほど速い
5. 『Create new project』

（待ち時間：約2分）

作成中ですね。
この間に、重要な概念を説明します。」

---

### トーク7：APIキーの管理

「Supabaseができたら、**APIキー**を取得します。

APIキー = アプリがSupabaseにアクセスするための『パスワード』

**2種類のキーがあります：**

1. **Publishable Key（公開可能キー）**
   - `sb_publishable_...`
   - フロントエンドで使う
   - 公開してもOK（制限あり）

2. **Secret Key（秘密キー）**
   - `sb_secret_...`
   - サーバーで使う
   - **絶対に公開しちゃダメ！**

これを`.env.local`ファイルに保存します。

（Supabaseの画面に戻る）

プロジェクトができましたね！

**APIキーの取得：**

1. Settings → API
2. Project URL をコピー
3. Publishable key をコピー
4. Secret key をコピー

全部メモ帳に貼り付けておいてください。
後で使います。」

---

### 実演：テーブル作成

「次に、テーブルを作ります。

**方法は2つ：**
1. GUIで作る（Table Editor）
2. SQLで作る（SQL Editor）

今日は、**AIにSQLを書かせて**実行します。

（Cursorを開く）

『Supabaseでusersテーブルとpostsテーブルを作成するSQLを生成して。
- usersテーブル：email, username, avatar_url
- postsテーブル：user_id, content, image_url
- UUID型の主キー、タイムスタンプ付き
- ユーザー削除時は投稿も削除（CASCADE）』

（AIが生成）

はい、完璧なSQLが出ました！

```sql
-- ユーザーテーブル
CREATE TABLE users (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  email TEXT UNIQUE NOT NULL,
  username TEXT NOT NULL,
  avatar_url TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 投稿テーブル
CREATE TABLE posts (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  content TEXT NOT NULL,
  image_url TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);
```

これをSupabaseで実行します。

（Supabase Dashboard → SQL Editor）

1. SQL Editorを開く
2. 生成されたSQLを貼り付け
3. 『Run』をクリック

（実行）

Success！

Table Editorで確認してみましょう...

（Table Editorを開く）

ほら、テーブルができました！

**これ、従来なら1時間かかる作業です。**
**AIを使えば3分。**」

---

### トーク8：RLS（セキュリティ）

「さて、最も重要な部分です。

**RLS = Row Level Security**
行レベルセキュリティ

これは何かというと...

**『自分のデータしか触れない』を強制する仕組み**

例えば、SNSで...
- 自分の投稿は編集・削除できる
- 他人の投稿は見られるけど、編集・削除はできない

これを**データベース側で**強制します。

なぜ重要か？

もしこれがないと...

（画面を見せながら）

悪意あるユーザーが、ブラウザの開発者ツールで
APIリクエストを改ざんして、
他人の投稿を削除できちゃいます。

**RLSがあれば、データベースが弾いてくれます。**

実装しましょう。

（Cursorに指示）

『postsテーブルにRLSポリシーを設定して。
- 全員が投稿を閲覧可能
- 投稿者本人のみ編集・削除可能
- ログインユーザーのみ新規投稿可能』

（AIが生成）

```sql
-- RLS有効化
ALTER TABLE posts ENABLE ROW LEVEL SECURITY;

-- 閲覧ポリシー
CREATE POLICY "Posts are viewable by everyone"
ON posts FOR SELECT
USING (true);

-- 作成ポリシー
CREATE POLICY "Users can create own posts"
ON posts FOR INSERT
WITH CHECK (auth.uid() = user_id);

-- 更新・削除ポリシー
CREATE POLICY "Users can update own posts"
ON posts FOR UPDATE
USING (auth.uid() = user_id);
```

これもSQL Editorで実行します。

（実行）

完璧！

これで、セキュアなデータベースが完成しました！」

---

### トーク9：テストデータ投入

「最後に、テストデータを入れましょう。

開発するときは、ダミーデータがあると便利です。

（Cursorに指示）

『usersテーブルに3人のテストユーザー、
postsテーブルに5件の投稿を追加するSQLを生成して。
日本人っぽい名前で、投稿は日本語のカジュアルな内容で。』

（AIが生成）

いい感じですね！
これも実行します。

（SQL Editorで実行）

Table Editorで確認...

（確認）

データが入りました！

これで、Session 1は完了です！」

---

## まとめ（5分）

### クロージングトーク

「お疲れ様でした！

**今日の前半で学んだこと：**

1. **データベースの必要性**
   - スプレッドシートとの違い
   - 大規模アプリには必須

2. **基本概念の理解**
   - テーブル、レコード、カラム
   - リレーション（外部キー）

3. **AIを使った開発**
   - SQLを覚えなくていい
   - 日本語で指示するだけ

4. **Supabaseでの実装**
   - プロジェクト作成
   - テーブル作成
   - RLSでセキュリティ

これで、あなたのアプリは
**データを保存できる**ようになりました！

でも、まだ足りないものがあります。

**『誰が』そのデータを作ったのか**

これを管理するのが『認証』です。

10分休憩の後、Session 2で認証を実装します！」

---

# 🚻 休憩（10分）

---

# Session 2: 認証基礎とClerk実装（75分）

## オープニング（3分）

### 導入トーク

「お帰りなさい！

前半でデータベースができましたね。
でも、今のままだと...

『誰でもデータを見られる』
『誰でもデータを消せる』

これじゃダメですよね。

そこで、**認証システム**を実装します。

認証があれば...
- ユーザーごとにデータを分けられる
- 自分のデータだけ操作できる
- 他人のデータは守られる

Session 2では、
**Clerk**を使って、
**10分で認証を実装**します！」

---

## 第1部：認証・認可の基礎（20分）

### トーク10：認証と認可の違い

「まず、重要な概念を理解しましょう。

**認証（Authentication）**
**認可（Authorization）**

この2つ、似てるけど全然違います。

マンションの例で説明しますね。

（スライドを表示）

**認証 = 入館許可**
- あなたが住民かどうかを確認
- 住民カードで本人確認
- OKなら中に入れる

**認可 = 各部屋の利用権限**
- 自分の部屋：開けられる ✅
- 他人の部屋：開けられない ❌
- 共用ジム：契約による
- 屋上：住民全員OK

つまり...

**認証 = 『誰なの？』を確認**
**認可 = 『何ができるの？』を管理**

SNSアプリで言うと...

**認証：**
- ログイン画面でメール・パスワード入力
- 『あなたは山田太郎さんですね』

**認可：**
- 自分の投稿：編集・削除できる ✅
- 他人の投稿：見るだけ ❌
- 管理画面：管理者のみ

分かりましたか？」

---

### トーク11：なぜ認証を自作してはいけないのか

「ここで、**超重要な話**をします。

Webアプリを作るとき、
『認証くらい自分で作れるでしょ』
って思いませんか？

**絶対にダメです。**

なぜか。

認証の自作は、
**『手術を素人がやるようなもの』**
です。

考えてみてください。
- 自宅の鍵を自作しますか？
- 銀行の金庫を自作しますか？
- パスポートを自作しますか？

全部NOですよね。

認証も同じです。

**実際に起こった事件：**

（スライドを表示）

- 2023年：某スタートアップ、認証の実装ミスで
  **500万人の個人情報流出**

- 2024年：大手ECサイト、セッション管理の不備で
  **1億円の不正購入被害**

- 2025年：AIボットによる大規模アカウント乗っ取り
  **標的は自作認証のサイト**

怖いでしょ？

認証を自作すると...

（スライドを表示）

**対応が必要な技術要件：**
- パスワードのハッシュ化（bcrypt, Argon2）
- ソルトの生成と管理
- セッション管理
- CSRF対策
- SQLインジェクション対策
- XSS対策
- レインボーテーブル攻撃対策
- タイミング攻撃対策
- ...他30個以上

**法的要件：**
- GDPR対応（違反すると最大20億円の罰金）
- 個人情報保護法対応
- CCPA対応
- データポータビリティ
- 忘れられる権利
- セキュリティインシデント時の72時間以内報告義務

これ、全部自分で対応できますか？

**無理ですよね。**

だから、プロが作ったサービスを使います。

それが**Clerk**です。」

---

### トーク12：Clerkのメリット

「Clerkは、認証のすべてを代行してくれます。

（スライドを表示）

**実装時間の比較：**

| 方法 | 時間 |
|-----|------|
| 自作認証 | 4週間+ |
| Auth0 | 2-3時間 |
| Firebase Auth | 1時間 |
| **Clerk** | **30分** |

**価格の比較（月額）：**

| サービス | 価格 |
|---------|------|
| 自作認証 | 35万円（開発費・保守費） |
| Auth0 | 24,000円〜 |
| **Clerk** | **2,500円〜** |

しかも、Clerkは...

**標準機能：**
- メール・パスワード認証
- Google, GitHub, Apple等20+のソーシャルログイン
- 多要素認証（MFA）
- パスワードレス認証
- マジックリンク
- 美しいUIコンポーネント
- 日本語対応
- セッション管理
- Webhook
- 組織管理

**セキュリティ：**
- 自動的に最新の脅威に対応
- AIによる不正検知
- GDPR, CCPA完全対応
- SOC 2 Type II認証済み

これが全部、**30分で**手に入ります。

使わない理由がないですよね！」

---

## 第2部：Clerk実装（35分）

### トーク13：OAuth 2.0の仕組み

「Googleログインって使ったことありますか？

『Googleでログイン』ボタンをクリックすると、
Googleの画面に飛んで、
ログインしたらアプリに戻ってくる。

あれ、どうやって動いてるか知ってます？

**OAuth 2.0**という仕組みです。

図で説明しますね。

（図を表示しながら）

1. あなた：『Googleでログイン』をクリック
2. アプリ：Clerkに『認証開始』と伝える
3. Clerk：Googleに『この人を認証して』と依頼
4. Google：あなたにログイン画面を表示
5. あなた：メール・パスワードを入力
6. Google：『本人確認OK』とClerkに伝える
7. Clerk：JWTトークンを発行
8. アプリ：トークンを受け取り、ログイン完了

この流れが、**数秒で**完了します。

しかも、Clerkを使えば
**あなたが書くコードはほぼゼロ**です。」

---

### 実演：Clerkプロジェクト作成

「では、実際にClerkを設定しましょう！

みなさんも一緒に操作してください。

**ステップ1：Clerkアカウント作成**

1. https://dashboard.clerk.com/sign-up を開く
2. GitHubでサインイン
3. 完了！

**ステップ2：アプリケーション作成**

1. 『Create application』をクリック
2. アプリ名を入力
   - 例：`My Social App`
3. 認証方法を選択
   - Email ✅
   - Google ✅ ← これONにしてください
4. 『Create application』

（待機：数秒）

できましたね！

**重要：開発環境と本番環境の違い**

今日は**開発環境**で進めます。
開発環境では、Googleログインの設定が
**超簡単**です。

なぜなら、Clerkが
**共有のGoogle認証情報**を提供してくれるから。

つまり、Google Cloud Consoleの設定は
**今日は不要！**

本番環境（Vercelにデプロイする時）には
必要になりますが、それは次回説明します。

今日は、**スイッチをONにするだけ**で
Googleログインが使えます！

簡単でしょ？」

---

### 実演：環境変数の設定

「次に、APIキーを取得します。

（Clerk Dashboardで操作）

1. 『API Keys』タブをクリック
2. 2つのキーが表示されます

**Publishable Key（公開可能キー）**
```
pk_test_xxxxxxxxxxxxx
```
→ これはフロントエンドで使う

**Secret Key（秘密キー）**
```
sk_test_xxxxxxxxxxxxx
```
→ これはサーバーで使う、**絶対に秘密！**

両方コピーしてください。

次に、プロジェクトに設定します。

（VSCodeを開く）

プロジェクトのルートに
`.env.local`ファイルを作ります。

```env
# Clerk
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_xxxxxxxxxxxxx
CLERK_SECRET_KEY=sk_test_xxxxxxxxxxxxx

# URL設定
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/dashboard
NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/dashboard
```

貼り付けましたか？

**重要な注意事項：**

このファイルは`.gitignore`に追加してください。

（.gitignoreを確認）

```
.env.local
```

これがないと、GitHubに
**秘密のキーがアップロードされて**
大変なことになります！

確認してくださいね。」

---

### トーク14：AIに実装させる

「さて、ここからが**魔法の時間**です。

ClerkにはAI用のプロンプトが用意されています。

（ブラウザで開く）

https://clerk.com/docs/ai-prompts/nextjs

ここに、完璧なプロンプトがあります。

これを、Cursorに貼り付けるだけ。

（実演）

1. プロンプト全体をコピー
2. Cursorを開く
3. チャットに貼り付け
4. 環境変数（APIキー）を追加
5. 『実装してください』

（AIが動作するのを待つ）

見てください。
今、AIが自動的に...

- パッケージをインストール
- layout.tsxにClerkProviderを追加
- middleware.tsを作成
- サインインページを作成
- サインアップページを作成
- 認証コンポーネントを配置

全部、**自動で**やってます。

（完了を待つ）

完了！

じゃあ、動かしてみましょう。

```bash
npm run dev
```

（ブラウザでlocalhost:3000を開く）

ログインボタンが表示されました。
クリックしてみます...

（クリック）

美しいログイン画面が表示されました！

『Googleでログイン』をクリック...

（Googleログイン画面）

メールアドレスを選択...

（ログイン完了）

ログイン成功！

**これ、コードを1行も書いてません。**
**所要時間：5分。**

信じられますか？

これがAI時代の開発です！」

---

## 第3部：用語の理解（15分）

### トーク15：生成されたコードを理解する

「ただ、重要なことを伝えます。

**コードは書かなくていい。**
**でも、意味は理解しないといけない。**

なぜなら、
エラーが出たときに対処できないから。

生成されたファイルを見てみましょう。

（VSCodeで開く）

**1. .env.local**

```env
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=...
```

`NEXT_PUBLIC_`がついてる理由は？

→ ブラウザ（クライアント側）でも使う設定だから。

`NEXT_PUBLIC_`がないと、
サーバーでしか使えません。

**2. app/layout.tsx**

```typescript
<ClerkProvider>
  {children}
</ClerkProvider>
```

これは何をしてる？

→ アプリ全体を`ClerkProvider`で囲むことで、
すべてのページで認証機能が使えるようになります。

電気の配電盤みたいなもの。
これがあるから、全部屋に電気が届く。

**3. middleware.ts**

```typescript
export default clerkMiddleware((auth, request) => {
  if (!auth().userId && isProtectedRoute(request)) {
    return redirectToSignIn({ returnBackUrl: request.url })
  }
})
```

これは『門番』です。

保護されたページ（/dashboardとか）に
未ログインでアクセスしようとすると、
『ログインページに戻って！』って言います。

マンションの管理人さんですね。

こういう理解があると、
エラーが出たときに対処できます。」

---

### トーク16：重要な用語集

「認証システムでよく出てくる用語を整理します。

（スライドを表示）

| 用語 | 意味 | 例え |
|-----|------|------|
| **Provider** | 機能提供者 | 電力会社 |
| **Middleware** | 中間処理 | 門番 |
| **Session** | ログイン状態 | 入館証の有効期限 |
| **Token** | 認証チケット | 切符 |
| **JWT** | 認証情報の形式 | パスポート |
| **Public Route** | 公開ページ | 誰でも入れる |
| **Protected Route** | 保護ページ | 会員限定 |

これ、頭に入れておいてください。

エラーメッセージに出てきたとき、
意味が分かるようになります。」

---

## まとめ（2分）

### クロージングトーク

「お疲れ様でした！

**Session 2で学んだこと：**

1. **認証と認可の違い**
   - 認証 = 誰なのか
   - 認可 = 何ができるか

2. **認証を自作してはいけない理由**
   - 技術的複雑性
   - 法的責任
   - セキュリティリスク

3. **Clerkの実装**
   - 30分で完成
   - AIが全部やってくれる

4. **用語の理解**
   - Provider, Middleware, Token...
   - エラー対処に必要

これで、あなたのアプリには
**認証システム**が実装されました！

でも、まだ完成じゃありません。

**データベース（Session 1）**と
**認証（Session 2）**を
**繋げないと**いけません。

それが次のSession 3です！

5分休憩の後、仕上げに入ります！」

---

# 🚻 休憩（5分）

---

# Session 3: 実装ロードマップと宿題（30分）

## オープニング（2分）

### 導入トーク

「お帰りなさい！

今日ここまでで...
- データベース ✅（Supabase）
- 認証システム ✅（Clerk）

2つのパーツができました。

でも、これ別々ですよね。

**今から繋げます。**

そして、それが**宿題**になります。

Session 3では、
実装の道筋を示します。

安心してください。
**魔法のプロンプト**があります。」

---

## 第1部：統合アーキテクチャ（8分）

### トーク17：全体像の理解

「まず、全体像を理解しましょう。

（図を表示）

```
┌─────────────────┐
│  Next.js App    │ ← フロントエンド（前回作った）
└─────────────────┘
        ↓
┌─────────────────┐
│     Clerk       │ ← 認証（今日作った）
│  「誰なのか」    │
└─────────────────┘
        ↓ JWT Token
┌─────────────────┐
│   Supabase      │ ← データベース（今日作った）
│ 「データ管理」   │
└─────────────────┘
        ↓ RLS
┌─────────────────┐
│ ユーザーデータ   │
│（自分のだけ見える）│
└─────────────────┘
```

流れを説明します。

1. ユーザーがClerkでログイン
2. ClerkがJWTトークンを発行
   （これが『パスポート』）
3. アプリがSupabaseにアクセスするとき、
   このトークンを持っていく
4. Supabaseがトークンを確認
   『この人は山田太郎さんね』
5. RLS（セキュリティルール）が動く
   『山田太郎さんは自分のデータだけ見られる』
6. データを返す

この仕組みで、
**セキュアなデータ管理**ができます。」

---

### トーク18：実装する機能

「これから実装する機能を整理します。

**必須機能（CRUD）：**

1. **Create（作成）**
   - 新しい投稿を作成
   - 自動的に自分のuser_idが入る

2. **Read（読取）**
   - タイムラインを表示
   - 自分の投稿には『編集』ボタン

3. **Update（更新）**
   - 自分の投稿を編集
   - 他人の投稿は編集不可

4. **Delete（削除）**
   - 自分の投稿を削除
   - 他人の投稿は削除不可

**発展機能（チャレンジ）：**
- いいね機能
- プロフィール編集
- リアルタイム更新

まずは必須機能を完成させましょう。」

---

## 第2部：魔法のプロンプト（15分）

### トーク19：QUICK_START_PROMPTの紹介

「さて、お待たせしました。

**魔法のプロンプト**を公開します。

（画面共有）

`supabase_prompt`フォルダを開いてください。

この中に...

```
📁 supabase_prompt/
├── 🎯 QUICK_START_PROMPT.md  ← これ！
├── MASTER_INTEGRATION_PROMPT.md
├── clerk_setupprpompt.md
├── supabase_bootstrap_nextjs.md
└── ...
```

**QUICK_START_PROMPT.md**

これを開くと...

（ファイルを開く）

11個のシナリオが用意されています。

**シナリオ1：ゼロからの完全統合**
→ これが最強。全部やってくれる。

**何をやってくれるか？**

（スライドを表示）

| 実装内容 | 詳細 |
|---------|------|
| 環境構築 | パッケージインストール、環境変数設定 |
| Clerk認証 | ログイン・サインアップページ、認証ミドルウェア |
| Supabaseクライアント | SSR対応、型安全なクライアント作成 |
| データベース | マイグレーションファイル、テーブル定義 |
| セキュリティ | RLS設定、ユーザーごとのデータ制御 |
| ユーザー同期 | ClerkとSupabaseのユーザー情報を自動同期 |
| CRUD操作 | 作成・読取・更新・削除の全実装 |
| Server Actions | Next.js 14の最新パターン |
| フロントエンドUI | フォーム、リスト表示、削除確認ダイアログ |
| Webhook | Clerkイベントの自動処理 |

**これ全部、自動生成されます。**

従来なら3日かかる作業が、
**30分で完成**します。」

---

### 実演：プロンプトの使い方

「実際にやってみせます。

（Cursorを開く）

1. QUICK_START_PROMPT.mdを開く

2. シナリオ1を選ぶ

3. プロンプトをコピー

4. Cursorのチャットに貼り付け

5. 環境変数（APIキー）を追加
   - Clerk: pk_test_..., sk_test_...
   - Supabase: https://xxx.supabase.co, eyJ...

6. 『これで実装してください』

（AIが動作）

見てください。
今、AIが...

- ファイルを作成
- コードを生成
- テーブルを作成
- セキュリティを設定
- UIを実装

全部、自動で進んでます。

（5分待機）

完了しました！

動かしてみましょう。

```bash
npm run dev
```

（ブラウザで確認）

1. ログインします
2. 投稿を作成
3. タイムラインに表示される
4. 編集ボタンをクリック
5. 内容を変更
6. 保存

（実演）

完璧に動いてます！

しかも、別のユーザーでログインすると...

（別アカウントでログイン）

さっきの投稿が見えますが、
『編集』ボタンがない！

なぜなら、他人の投稿だから。

**RLSが正しく動いてます。**

これ、信じられますか？

**30分で、本番レベルのアプリが完成しました。**」

---

## 第3部：宿題説明（5分）

### トーク20：宿題の内容

「では、宿題を説明します。

**宿題：認証付きCRUDアプリの完成**

**必須タスク：**

1. **認証機能**
   - [ ] Googleログインできる
   - [ ] ログアウトできる
   - [ ] UserButtonが表示される

2. **投稿機能**
   - [ ] 新規投稿を作成できる
   - [ ] 投稿一覧が表示される
   - [ ] 自分の投稿のみ編集・削除できる

3. **データ永続化**
   - [ ] Supabaseにデータが保存される
   - [ ] ページをリロードしてもデータが残る

**発展タスク（余力があれば）：**
- いいね機能
- プロフィール編集
- リアルタイム更新

**期限：次回セッションまで**

**やること：**

1. QUICK_START_PROMPT.mdを使って実装
2. 動作確認
3. GitHubにプッシュ
4. README.mdに実装内容を記載
5. SlackでURL共有

簡単でしょ？

だって、プロンプトが全部やってくれるから。」

---

### トーク21：トラブルシューティング

「よくあるエラーと対処法を説明します。

**エラー1：環境変数が見つかりません**

```
Missing NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY
```

**対処法：**
1. `.env.local`ファイルがあるか確認
2. キーが正しくコピーされているか確認
3. **開発サーバーを再起動**（重要！）

```bash
npm run dev
```

環境変数を変更したら、
**必ず再起動**してください。

**エラー2：RLSエラー**

```
new row violates row-level security policy
```

**対処法：**
1. Supabase Dashboard → Policies
2. 該当テーブルのポリシーを確認
3. `auth.jwt() ->> 'sub'`が正しいか確認

**エラー3：データが表示されない**

**対処法：**
1. ブラウザのコンソールを確認
2. Supabase Table Editorでデータを確認
3. RLSポリシーを確認

詰まったら、
**すぐSlackで質問してください！**

一人で悩まないでくださいね。」

---

## クロージング（5分）

### 最終トーク

「お疲れ様でした！

**今日の第三回で学んだこと：**

**Session 1（90分）：**
- データベース基礎
- Supabaseでの実装
- RLSでセキュリティ

**Session 2（75分）：**
- 認証・認可の違い
- Clerkでの実装
- 用語の理解

**Session 3（30分）：**
- 統合アーキテクチャ
- 魔法のプロンプト
- 宿題説明

これで、あなたは
**フルスタック開発者**の仲間入りです！

3週間前を思い出してください。

HTMLも知らなかった。
CSSも知らなかった。

でも今、
- フロントエンド（React/Next.js）
- データベース（Supabase）
- 認証（Clerk）

全部扱えるようになりました。

**これ、すごいことです！**

自信を持ってください。

宿題は、今日学んだことの総復習です。

QUICK_START_PROMPTを使えば、
**30分で完成**します。

でも、焦らなくていい。
1週間あります。

毎日30分、触ってみてください。
少しずつ理解が深まります。

詰まったら、すぐ質問。
分からないことは、恥ずかしくない。

むしろ、質問しないほうが
学習機会を逃します。

---

**次回予告：第四回**

次回は、作ったアプリを
**世界に公開**します！

- Vercelへのデプロイ
- カスタムドメイン設定
- 本番環境の設定
- パフォーマンス最適化

あなたのアプリが、
誰でもアクセスできるようになります。

ポートフォリオとして
就職活動にも使えます。

楽しみにしていてください！

---

**最後に一言**

みなさん、本当によく頑張りました。

今日の内容は、
従来のカリキュラムなら
**3ヶ月かかる**内容です。

それを3時間で理解した。

AI時代だからこそ、
こんな高速学習ができます。

でも、忘れないでください。

**AIはツールです。**
**考えるのはあなたです。**

AIに指示を出すのも、
生成されたコードを理解するのも、
エラーを解決するのも、
全部あなたの力。

あなたは、もうVibe Coderです。

自信を持って、
宿題に取り組んでください。

次回、みなさんの作品を
見られることを楽しみにしています！

お疲れ様でした！」

---

## 📋 講師向けチェックリスト

### Session 1
- [ ] スプレッドシート演習の準備
- [ ] Supabaseアカウント作成のサポート
- [ ] SQL生成のデモ
- [ ] RLS設定のデモ

### Session 2
- [ ] 認証事例の準備
- [ ] Clerkアカウント作成のサポート
- [ ] AIプロンプトのデモ
- [ ] 動作確認

### Session 3
- [ ] QUICK_START_PROMPTの配布
- [ ] 実装デモ
- [ ] 宿題の明確な説明
- [ ] トラブルシューティング資料の共有

---

**End of Script**

