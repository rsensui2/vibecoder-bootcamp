# デプロイ完全ガイド - VibeCoder育成プログラム

このドキュメントは、VibeCoder育成プログラムの教材内容から、RAGシステムを使用してデプロイに関する情報を抽出・整理したものです。

## 目次
1. [デプロイとは](#デプロイとは)
2. [開発モードと本番モードの違い](#開発モードと本番モードの違い)
3. [ビルドプロセスの理解](#ビルドプロセスの理解)
4. [Vercelを使用したデプロイ](#vercelを使用したデプロイ)
5. [環境変数の設定](#環境変数の設定)
6. [デプロイ前チェックリスト](#デプロイ前チェックリスト)
7. [トラブルシューティング](#トラブルシューティング)

---

## デプロイとは

デプロイとは、開発したアプリケーションを世界中の誰もがアクセスできるようにするプロセスです。これまでの開発がすべてローカル環境（あなたのPC内）で行われてきたものを、インターネット上に公開する作業になります。

### AI駆動開発におけるデプロイの位置づけ

AI駆動開発のワークフローにおいて、デプロイは以下の流れの最終段階に位置します：

1. **アイデア生成**: AIとの対話で要件を明確化
2. **プロトタイプ作成**: v0やCursorを使い、アイデアを即座に動く形にする
3. **フィードバック収集**: プロトタイプを関係者やユーザーに見せ、改善点を引き出す
4. **反復改善**: フィードバックを基に、Cursor等で即座にコードを修正・改善
5. **本格開発**: 検証済みのプロトタイプをベースに、本番品質のコードを実装
6. **デプロイ・運用**: Vercelなどのプラットフォームを使い、数クリックで世界に公開

---

## 開発モードと本番モードの違い

### レストランで例えると

| 項目 | `npm run dev` (開発モード) | `npm run build` (本番モード) |
|:---|:---|:---|
| **目的** | 開発者が効率よく作業するため | ユーザーが快適にアプリを使うため |
| **状態** | 厨房での試作 | お客様への提供料理 |
| **特徴** | - 変更が即座に反映される<br>- デバッグ情報が豊富<br>- 動作は遅く、ファイルサイズも大きい | - コードが圧縮・最適化されている<br>- 不要なデータは削除<br>- 動作は非常に高速で、ファイルサイズも小さい |

`npm run dev`は、料理人が最高の味を求めて何度も味見や調整をするための機能満載の実験室です。一方、`npm run build`は、完成したレシピに基づき、最高の料理を最も効率的かつ美しい形でお客様に提供するためのプロセスです。

---

## ビルドプロセスの理解

`npm run build`コマンドを実行すると、Next.jsは以下の最適化を行います：

### 1. コードの変換（トランスパイル）
- TypeScriptや最新のJavaScript構文を、古いブラウザでも理解できるJavaScriptに変換
- より多くのユーザーが問題なくアプリを利用できるようになる

### 2. コードの圧縮（Minify）
- 不要なスペース、改行、コメントなどを削除
- 変数名を短いものに置き換え、ファイルサイズを劇的に削減

### 3. ファイルの結合（Bundling）
- 複数のJavaScriptやCSSファイルを一つにまとめる
- ブラウザがサーバーにリクエストする回数を減らし、表示速度を向上

### 4. 最適化
- 画像をWebPのようなモダンな形式に変換して軽量化
- 使われていないコードを自動的に削除
- パフォーマンスを向上させるための様々な最適化を実行

### 最重要原則
**「ローカルでビルドできなければ、本番でもビルドできない」**

もしローカル環境で`npm run build`コマンドがエラーになる場合、Vercelのサーバー上でも100%エラーになります。そのため、GitHubにプッシュする直前に、必ず手元で`npm run build`を実行し、エラーが出ないことを確認する習慣が重要です。

```bash
# 開発を終え、GitHubにプッシュする前に…

# 1. まずはローカルでビルドを試す
npm run build

# "Build successful" と表示されればOK！

# 2. エラーがなければ、いつも通りコミットしてプッシュ
git add .
git commit -m "feat: 新機能の追加とビルド確認"
git push
```

---

## Vercelを使用したデプロイ

### 推奨技術スタック

| 分野 | 技術 | 理由 |
|:---|:---|:---|
| フロントエンド | React 18 + TypeScript | 学習リソース豊富、型安全性 |
| スタイリング | Tailwind CSS | 高速開発、一貫性 |
| 状態管理 | Zustand | 軽量、学習コスト低 |
| バックエンド | Next.js API Routes | フルスタック開発、Vercel最適化 |
| データベース | Supabase (PostgreSQL) | 無料枠、認証機能内蔵 |
| 認証 | Supabase Auth / Clerk | 設定簡単、セキュア |
| ホスティング | Vercel | 無料枠、自動デプロイ |
| 開発環境 | Cursor | AI支援、高速開発 |

### コスト分析
- **開発コスト**: 無料（オープンソース）
- **運用コスト**: 月額0円〜（無料枠内）
- **学習コスト**: 低（既存React経験活用）

### 拡張性
- ユーザー数増加時: Vercel Pro、Supabase Proへアップグレード
- 機能追加時: Next.jsエコシステム活用
- チーム拡大時: TypeScriptによる型安全性でコラボレーション向上

### デプロイボタンの活用
プロジェクトはVercelでワンクリックデプロイが可能です：

```markdown
[![Deploy with Vercel](https://vercel.com/button)](https://vercel.com/new/clone?repository-url=https://github.com/username/your-project)
```

---

## 環境変数の設定

### なぜ環境変数を本番環境で設定する必要があるのか？

APIキーのような秘密情報は`.env.local`ファイルに記述しますが、このファイルは`.gitignore`によって**意図的にGitHubへアップロードされません**。これは重要なセキュリティ対策です。

```gitignore
# .gitignore の中身（一部）

# 環境変数
.env
.env.local
```

### Vercelでの環境変数設定手順

#### ステップ1：必要な環境変数をリストアップ
`.env.local`ファイルから、以下のような環境変数を確認：
- `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY`
- `CLERK_SECRET_KEY`
- `NEXT_PUBLIC_SUPABASE_URL`
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`

#### ステップ2：Vercelダッシュボードで設定
1. Vercelのダッシュボードにログインし、プロジェクトを選択
2. 「Settings」タブ → 「Environment Variables」を選択
3. キーと値を一つずつ入力：
   - **KEY**: `.env.local`のキー名を正確に入力
   - **VALUE**: 実際のキーの値を入力
   - `NEXT_PUBLIC_`で始まらないキーは、サーバーサイド専用の変数として扱われる
4. 全て設定後、「Save」をクリック

#### ステップ3：再デプロイと動作確認
1. 環境変数の追加・変更後、Vercelは通常自動で新しいデプロイをトリガー
2. 自動で始まらない場合は、「Deployments」タブから「Redeploy」を選択
3. デプロイ完了後、公開URLにアクセスして動作確認

### Supabaseの初期設定例
プロジェクト作成時、データベースパスワードは`GENERATE PASSWORD`ボタンでランダムな文字列を生成することが推奨されます。生成されたパスワードは、Cursorまたは要件定義書に安全に保管してください。

---

## デプロイ前チェックリスト

デプロイは「打ち上げ」です。失敗しないように、以下のチェックリストを確認しましょう：

### コード品質
- [ ] TypeScriptのエラーがないか (`npm run type-check`)
- [ ] ESLintのエラーがないか (`npm run lint`)
- [ ] ローカルでビルドが成功するか (`npm run build`)

### 環境変数
- [ ] `.env.local`に記載したAPIキーなどの機密情報が、Vercelの環境変数設定に正しくコピーされているか
- [ ] 環境変数が正しく読み込まれているか確認

### セキュリティ
- [ ] 機密情報（APIキーなど）がGitのコミット履歴に含まれていないか
- [ ] `.gitignore`に環境変数ファイルが含まれているか

---

## トラブルシューティング

### よくあるエラーと解決策

| 問題カテゴリ | 具体的な問題 | 主な解決策 |
|:---|:---|:---|
| **環境構築** | `npm install`失敗 | `node_modules`と`package-lock.json`を削除して再試行<br>Node.jsのバージョン確認 |
| **開発** | TypeScriptエラー | 型定義の確認<br>`tsconfig.json`の設定見直し |
| **実行時** | Hydrationエラー | サーバーとクライアントで描画されるHTMLの不一致を確認<br>`useEffect`を活用 |
| **デプロイ** | Vercelビルド失敗 | Vercelのビルドログを詳細に確認<br>ローカルでのビルド成功を再確認<br>環境変数の設定ミスを疑う |

### Vercelビルドエラーの対処法
1. Vercelのビルドログを詳細に確認する
2. ローカルでのビルドが成功するか再確認
3. Vercel側の環境変数が正しく設定されているか確認

### 頻繁に使うコマンド集

```bash
# 開発関連
npm run dev              # 開発サーバーを起動
npm run build            # プロダクション用にビルド

# 依存関係
npm install              # 依存関係をインストール
```

---

## まとめ

デプロイは、AI駆動開発の最終段階であり、作成したアプリケーションを世界に公開する重要なプロセスです。以下のポイントを押さえることで、スムーズなデプロイが可能になります：

1. **開発モードと本番モードの違いを理解する**
2. **ローカルでのビルド成功を必ず確認する**
3. **環境変数を適切に設定する**
4. **セキュリティに配慮した運用を心がける**

Vercelのような現代的なホスティングサービスを使用することで、複雑なインフラストラクチャの知識がなくても、数クリックで世界中にアプリケーションを公開できます。これにより、開発者はビジネスロジックとユーザー体験の向上に集中できるようになります。

---

*このドキュメントは、VibeCoder育成プログラムの教材からRAGシステムを使用して自動生成されました。*